<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>WebGL Black Hole</title>
        <link rel="stylesheet" href="./style.css">
        
        <!-- Open Graph -->
        <meta itemprop="name" content="WebGL Black Hole">
        <meta itemprop="description" content="">
        <meta itemprop="image" content="https://webgl-black-hole.vercel.app/social/share-1200x630.png">

        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title" content="WebGL Black Hole">
        <meta name="twitter:description" content="">
        <meta name="twitter:image" content="https://webgl-black-hole.vercel.app/social/share-1200x600.png">

        <meta property="og:site_name" content="WebGL Black Hole">
        <meta property="og:type" content="website">
        <meta property="og:url" content="https://webgl-black-hole.vercel.app">
        <meta property="og:title" content="WebGL Black Hole">
        <meta property="og:description" content="">
        <meta property="og:image" content="https://webgl-black-hole.vercel.app/social/share-1200x630.png">

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet">
        
        <!-- Three.js CDN -->
        <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>
        <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.141.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.141.0/examples/jsm/",
                "lil-gui": "https://unpkg.com/lil-gui@0.16.1/dist/lil-gui.esm.js",
                "stats.js": "https://unpkg.com/stats.js@0.17.0/build/stats.min.js"
            }
        }
        </script>
    </head>
    <body>
        <div class="experience"></div>

        <div class="credits">
            WebGL Black Hole by <a href="#" target="_blank">Rilker Andrade</a> (<a href="https://github.com/brunosimon/webgl-black-hole" target="_blank">Source code</a>)
        </div>

        <script type="module">
            console.log('Iniciando carregamento do projeto...');
            
            try {
                // Tentar carregar o projeto original
                console.log('Tentando importar Experience...');
                const module = await import('./index.js');
                console.log('Módulo carregado:', module);
                
                // Se chegou até aqui, o projeto carregou
                console.log('Projeto carregado com sucesso!');
                
            } catch (error) {
                console.error('Erro ao carregar projeto original:', error);
                
                // Fallback: criar uma versão básica do buraco negro
                console.log('Criando versão básica do buraco negro...');
                
                try {
                    const THREE = await import('three');
                    console.log('Three.js carregado para fallback');
                    
                    // Configurações básicas
                    const scene = new THREE.Scene();
                    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                    const renderer = new THREE.WebGLRenderer({ antialias: true });
                    
                    renderer.setSize(window.innerWidth, window.innerHeight);
                    renderer.setClearColor(0x000000, 1);
                    document.querySelector('.experience').appendChild(renderer.domElement);
                    
                    // Buraco negro básico
                    const geometry = new THREE.PlaneGeometry(4, 4, 32, 32);
                    const material = new THREE.ShaderMaterial({
                        vertexShader: `
                            varying vec2 vUv;
                            void main() {
                                vUv = uv;
                                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                            }
                        `,
                        fragmentShader: `
                            uniform float time;
                            varying vec2 vUv;
                            
                            void main() {
                                vec2 uv = vUv - 0.5;
                                float dist = length(uv);
                                
                                // Distorção do buraco negro
                                float distortion = 1.0 / (1.0 + dist * 10.0);
                                
                                // Disco de acreção
                                vec3 color = vec3(0.0);
                                if(dist > 0.3 && dist < 0.8) {
                                    float angle = atan(uv.y, uv.x);
                                    float spiral = sin(angle * 8.0 + time * 2.0) * 0.5 + 0.5;
                                    color = vec3(0.8, 0.2, 0.8) * spiral * distortion;
                                }
                                
                                // Partículas estelares
                                float stars = sin(uv.x * 100.0 + time) * sin(uv.y * 100.0 + time * 0.5);
                                stars = max(0.0, stars - 0.8) * 5.0;
                                color += vec3(stars);
                                
                                gl_FragColor = vec4(color, 1.0);
                            }
                        `,
                        uniforms: {
                            time: { value: 0 }
                        }
                    });
                    
                    const blackHole = new THREE.Mesh(geometry, material);
                    scene.add(blackHole);
                    
                    camera.position.z = 5;
                    
                    // Animação
                    let time = 0;
                    function animate() {
                        requestAnimationFrame(animate);
                        time += 0.01;
                        material.uniforms.time.value = time;
                        renderer.render(scene, camera);
                    }
                    
                    animate();
                    console.log('Versão básica criada com sucesso!');
                    
                } catch (fallbackError) {
                    console.error('Erro no fallback:', fallbackError);
                    document.querySelector('.experience').innerHTML = `
                        <div style="color: white; text-align: center; padding: 50px; font-family: Arial, sans-serif;">
                            <h2>Erro ao carregar a simulação</h2>
                            <p>Erro original: ${error.message}</p>
                            <p>Erro fallback: ${fallbackError.message}</p>
                            <p>Verifique o console para mais detalhes.</p>
                        </div>
                    `;
                }
            }
        </script>
    </body>
</html>